var canvas,context,canvasBounding,resourcesReady,entityList=[],renderList=[],mouseX=0,mouseY=0,mouseDown=!1,leftMouseDown=!1,middleMouseDown=!1,rightMouseDown=!1,automaticEntities=!0;function onStart(){}function createCanvas(width,height,container=""){var newCanvas=document.createElement("canvas");newCanvas.setAttribute("id","spring-surface"),newCanvas.setAttribute("width",width.toString()),newCanvas.setAttribute("height",height.toString()),newCanvas.oncontextmenu=function(event){event.preventDefault()},canvas=newCanvas,""!=container?document.getElementById(container).appendChild(canvas):document.body.appendChild(canvas),context=canvas.getContext("2d"),canvasBounding=canvas.getBoundingClientRect(),setupInput()}function setCanvas(canvasId){canvas=document.getElementById(canvasId),context=canvas.getContext("2d"),canvasBounding=canvas.getBoundingClientRect(),setupInput()}window.onload=function(){onStart()};class Sprite{constructor(imageSource,x,y,width,height){this.render=!0,this.ready=!1;var image=new Image;image.onload=function(){this.ready=!0},image.src=imageSource,this.image=image,this.x=x,this.y=y,this.width=width,this.height=height,automaticEntities&&entityList.push(this)}}class Rectangle{constructor(x,y,width,height,color="black",filled=!0){this.render=!0,this.x=x,this.y=y,this.width=width,this.height=height,this.color=color,this.filled=filled,automaticEntities&&entityList.push(this)}}class Circle{constructor(x,y,radius,color="black",filled=!0){this.render=render,this.x=x,this.y=y,this.radius=radius,this.color=color,this.filled=filled,automaticEntities&&entityList.push(this)}}class Line{constructor(startPoint,endPoint,color){this.render=!0,this.startPoint=startPoint,this.endPoint=endPoint,this.color=color,automaticEntities&&entityList.push(this)}}class Point{constructor(x,y){this.x=x,this.y=y}}class Text{constructor(text,x=0,y=0,font="12px serif",color="black",filled=!0){this.render=!0,this.text=text,this.x=x,this.y=y,this.font=font,this.color=color,this.filled=filled,automaticEntities&&entityList.push(this)}}function hide(renderObject){renderObject.render=!1}function show(renderObject){renderObject.render=!0}function toggle(renderObject){renderObject.render=!renderObject.render}function setupInput(){canvas.addEventListener("click",canvasClicked),canvas.addEventListener("mousemove",canvasMouseMoved),canvas.addEventListener("mousedown",canvasMouseDown),canvas.addEventListener("mouseup",canvasMouseUp),window.addEventListener("keydown",windowKeyDown),window.addEventListener("keyup",windowKeyUp),window.addEventListener("keypress",windowKeyPress)}function canvasClicked(event){onClick(getMouseButton(event.button))}function onClick(button){}function canvasMouseMoved(event){mouseX=event.clientX-canvasBounding.left,mouseY=event.clientY-canvasBounding.top,onMouseMove(mouseX,mouseY)}function onMouseMove(x,y){}function canvasMouseDown(event){mouseDown=!0,0==event.button&&(leftMouseDown=!0),1==event.button&&(middleMouseDown=!0),2==event.button&&(rightMouseDown=!0),onMouseDown(getMouseButton(event.button))}function onMouseDown(button){}function canvasMouseUp(event){mouseDown=!1,0==event.button&&(leftMouseDown=!1),1==event.button&&(middleMouseDown=!1),2==event.button&&(rightMouseDown=!1),onMouseUp(getMouseButton(event.button))}function onMouseUp(button){}function windowKeyDown(event){onKeyDown(new Key(event.keyCode,String.fromCharCode(event.keyCode)))}function onKeyDown(key){}function windowKeyUp(event){onKeyUp(new Key(event.keyCode,String.fromCharCode(event.keyCode)))}function onKeyUp(key){}function windowKeyPress(event){onKeyPress(new Key(event.keyCode,String.fromCharCode(event.keyCode)))}function onKeyPress(key){}function getMouseButton(button){return 0==button?"left":1==button?"middle":2==button?"right;":void 0}class Key{constructor(code,char){this.code=code,this.char=char}}function update(){if(onUpdate(),!resourcesReady){for(var readyCount=0,i=0;i<renderList.length;i++)renderList[i].ready&&readyCount++;readyCount==renderList.length-1&&(resourcesReady=!0)}render()}function onUpdate(){}function render(){var oldEntitySetting=automaticEntities;automaticEntities=!1,onRender(),automaticEntities=oldEntitySetting,context.clearRect(0,0,canvas.width,canvas.height);for(var i=0;i<renderList.length;i++){var current=renderList[i],type=current.constructor.name;current.render&&inFrame(current)&&("Sprite"==type&&context.drawImage(current.image,current.x,current.y,current.width,current.height),"Rectangle"==type&&(current.filled?(context.fillStyle=current.color,context.fillRect(current.x,current.y,current.width,current.height)):(context.strokeStyle=current.color,context.strokeRect(current.x,current.y,current.width,current.height))),"Circle"==type&&(current.filled?context.fillStyle=current.color:context.strokeStyle=current.color,context.beginPath(),context.arc(current.x+current.radius,current.y+current.radius,current.radius,0,2*Math.PI),current.filled?(context.closePath(),context.fill()):context.stroke()),"Line"==type&&(context.strokeStyle=current.color,context.beginPath(),context.moveTo(current.startPoint.x,current.startPoint.y),context.lineTo(current.endPoint.x,current.endPoint.y),context.stroke()),"Text"==type&&(current.filled?context.fillStyle=current.color:context.strokeStyle=current.color,context.font=current.font,current.filled?context.fillText(current.text,current.x,current.y):context.strokeText(current.text,current.x,current.y)))}renderList.splice(0,renderList.length)}function onRender(){drawAll()}function draw(renderObject){renderList.push(renderObject)}function drawAll(){entityList.forEach(renderObject=>renderList.push(renderObject))}function inFrame(renderObject){var type,specialCheck=!1;return"Line"==renderObject.constructor.name&&(specialCheck=!0),!(!specialCheck&&renderObject.x>canvasBounding.width||renderObject.y>canvasBounding.height||renderObject.x+renderObject.width<0||renderObject.y+renderObject.height<0)}function play(fps=60){window.setInterval(update,1e3/fps)}function getPNG(){canvas.toDataURL("image/png")}function randInt(min=0,max=1){return Math.round(Math.random()*(max-min)+min)}function hideCursor(){canvas.style.cursor="none"}function showCursor(){canvas.style.cursor="normal"}function outlineCanvas(){canvas.style.border="1px solid black"}function disableAutomaticEntities(){automaticEntities=!1}